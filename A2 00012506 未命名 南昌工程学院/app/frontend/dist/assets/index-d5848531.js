import{m as a,n as i,Z as c,p as h,$ as p}from"./index-06309a7e.js";const t=a.create({baseURL:"http://localhost:5000",timeout:1e4,withCredentials:!0,headers:{"Content-Type":"application/json"}});t.interceptors.request.use(e=>{const r=i();return r&&(e.headers.Authorization=`Bearer ${r}`),e},e=>Promise.reject(e));t.interceptors.response.use(e=>e.data,async e=>{var s;const r=e.config;if(((s=e.response)==null?void 0:s.status)===401&&!r._retry){r._retry=!0;try{const n=(await a.post("/auth/refresh")).data.token;return c(n),r.headers.Authorization=`Bearer ${n}`,t(r)}catch(o){return h(),window.location.pathname!=="/login"&&(window.location.href="/login"),Promise.reject(o)}}return p.handleApiError(e,"API请求",!1),Promise.reject(e)});export{t as a};
