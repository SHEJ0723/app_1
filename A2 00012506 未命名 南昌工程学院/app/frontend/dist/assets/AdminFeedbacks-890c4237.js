import{a as m}from"./index-d5848531.js";import{C}from"./CommonButton-70b7e8fe.js";import{_ as V,r as y,s as w,b as n,o as r,c as p,e as s,d,f as _,t as i,j as B,E as u,h as b}from"./index-06309a7e.js";const D={class:"admin-feedbacks-container"},F={key:0},I={style:{color:"#888","font-size":"12px"}},N={key:1,style:{color:"#aaa"}},$={key:0,class:"reply-panel"},A={style:{"font-weight":"600","margin-bottom":"8px"}},E={__name:"AdminFeedbacks",setup(S){const c=y([]),a=y(null),v=async()=>{try{const t=await m.get("/api/feedbacks");c.value=(t.data||[]).map(e=>({...e,_reply:""}))}catch{c.value=[]}},f=t=>{a.value=t},k=async t=>{if(!t._reply){u.error("请输入回复内容");return}try{await m.put(`/feedbacks/${t.id}/reply`,{reply:t._reply}),u.success("回复成功"),t.reply=t._reply,t.reply_at=new Date().toISOString(),t._reply="",a.value=null}catch(e){u.error(e.message||"回复失败")}};return w(v),(t,e)=>{const o=n("el-table-column"),x=n("el-table"),h=n("el-input"),g=n("el-button");return r(),p("div",D,[s(C,{class:"pretty-btn back-btn",type:"secondary",size:"small",text:"返回",onClick:e[0]||(e[0]=l=>t.$router.back())}),e[5]||(e[5]=d("h2",null,"客户反馈信息",-1)),s(x,{data:c.value,style:{width:"96%",margin:"32px auto 0 auto","min-height":"320px"},onRowClick:f},{default:_(()=>[s(o,{prop:"user_id",label:"用户ID",width:"120"}),s(o,{prop:"content",label:"反馈内容","min-width":"200"}),s(o,{prop:"created_at",label:"提交时间",width:"200"}),s(o,{label:"管理员回复","min-width":"220"},{default:_(({row:l})=>[l.reply?(r(),p("div",F,[b(i(l.reply),1),e[3]||(e[3]=d("br",null,null,-1)),d("span",I,i(l.reply_at?l.reply_at.replace("T"," ").slice(0,19):""),1)])):(r(),p("div",N,"暂未回复"))]),_:1})]),_:1},8,["data"]),a.value?(r(),p("div",$,[d("div",A,"回复用户ID: "+i(a.value.user_id)+"，内容："+i(a.value.content),1),s(h,{modelValue:a.value._reply,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value._reply=l),type:"textarea",rows:3,placeholder:"输入回复内容...",style:{width:"420px","max-width":"90%","margin-bottom":"12px"}},null,8,["modelValue"]),s(g,{class:"pretty-btn",type:"primary",onClick:e[2]||(e[2]=l=>k(a.value))},{default:_(()=>e[4]||(e[4]=[b("回复")])),_:1,__:[4]})])):B("",!0)])}}},T=V(E,[["__scopeId","data-v-14b2a442"]]);export{T as default};
