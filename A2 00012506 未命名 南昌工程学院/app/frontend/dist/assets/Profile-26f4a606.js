import{_ as B,r as u,s as k,u as M,b as r,o as m,c as P,d as s,l as b,f as n,e as o,h as f,F as N,J as j,t as q,g as z,E as g}from"./index-06309a7e.js";import{a as E}from"./index-d5848531.js";import{C as V}from"./CommonButton-70b7e8fe.js";const J={class:"fade-in"},Q={class:"mb-6 flex justify-end"},T={class:"bg-white rounded-lg shadow-sm border border-gray-100 p-6 mb-6"},K={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},O={class:"bg-white rounded-lg shadow-sm border border-gray-100 p-6"},Z={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},D={class:"space-y-3"},L={class:"flex flex-wrap gap-2"},R={class:"flex gap-3 items-center"},G={__name:"Profile",setup(H){const l=u({name:"",phone:"",email:"",licensePlates:[]}),i=u(""),F={phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"手机号格式不正确",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"邮箱格式不正确",trigger:"blur"}]},_=u(null);u([{id:1,read:!1},{id:2,read:!1},{id:3,read:!0}]);const v=u(0);k(async()=>{const t=await E.get("/api/messages");v.value=(t.data||[]).filter(e=>!e.is_read).length});const y=M();function x(){y.push({name:"UserMessages"})}function c(t){const e={Password:"UserPassword",Feedback:"Feedback",FAQ:"FAQ",ContactInfo:"ContactInfo"};y.push({name:e[t]||t})}k(async()=>{try{const t=JSON.parse(localStorage.getItem("userInfo"));t&&(l.value.name=t.name,l.value.phone=t.phone,l.value.email=t.email,l.value.licensePlates=t.licensePlates||[])}catch{}});function w(){const t=i.value.trim().toUpperCase();if(t){if(l.value.licensePlates.includes(t)){g.warning("该车牌已存在");return}if(!/^([\u4e00-\u9fa5][A-Z][A-Z0-9]{5,7})$/.test(t)){g.warning("请输入有效的车牌号");return}l.value.licensePlates.push(t),i.value=""}}function I(t){l.value.licensePlates.splice(t,1)}const U=()=>{_.value.validate(async t=>{if(t)try{g.success("保存成功"),localStorage.setItem("userInfo",JSON.stringify(l.value))}catch{g.error("保存失败")}})};return(t,e)=>{const $=r("el-badge"),p=r("el-input"),d=r("el-form-item"),S=r("el-tag"),C=r("el-button"),h=r("el-form");return m(),P("div",J,[e[18]||(e[18]=s("div",{class:"mb-6"},[s("h2",{class:"text-[clamp(1.25rem,3vw,1.75rem)] font-semibold"},"个人资料"),s("p",{class:"text-gray-500 mt-1"},"管理您的个人信息和账户设置")],-1)),s("div",Q,[v.value>0?(m(),b($,{key:0,value:v.value},{default:n(()=>[o(V,{type:"primary",size:"medium",onClick:x,class:"msg-btn"},{default:n(()=>e[8]||(e[8]=[s("i",{class:"fa fa-bell mr-2"},null,-1),f(" 消息中心 ")])),_:1,__:[8]})]),_:1},8,["value"])):(m(),b(V,{key:1,type:"primary",size:"medium",onClick:x,class:"msg-btn"},{default:n(()=>e[9]||(e[9]=[s("i",{class:"fa fa-bell mr-2"},null,-1),f(" 消息中心 ")])),_:1,__:[9]}))]),s("div",T,[e[14]||(e[14]=s("div",{class:"flex justify-between items-center mb-6"},[s("h3",{class:"font-medium text-lg"},"快捷设置"),s("p",{class:"text-gray-500 text-sm"},"常用功能快速访问")],-1)),s("div",K,[s("div",{class:"setting-card",onClick:e[0]||(e[0]=a=>c("Password"))},e[10]||(e[10]=[s("div",{class:"setting-icon bg-primary/10 text-primary"},[s("i",{class:"fa fa-lock"})],-1),s("span",{class:"setting-text"},"修改密码",-1)])),s("div",{class:"setting-card",onClick:e[1]||(e[1]=a=>c("Feedback"))},e[11]||(e[11]=[s("div",{class:"setting-icon bg-success/10 text-success"},[s("i",{class:"fa fa-edit"})],-1),s("span",{class:"setting-text"},"意见反馈",-1)])),s("div",{class:"setting-card",onClick:e[2]||(e[2]=a=>c("FAQ"))},e[12]||(e[12]=[s("div",{class:"setting-icon bg-warning/10 text-warning"},[s("i",{class:"fa fa-question-circle"})],-1),s("span",{class:"setting-text"},"常见问题",-1)])),s("div",{class:"setting-card",onClick:e[3]||(e[3]=a=>c("ContactInfo"))},e[13]||(e[13]=[s("div",{class:"setting-icon bg-info/10 text-info"},[s("i",{class:"fa fa-phone"})],-1),s("span",{class:"setting-text"},"联系客服",-1)]))])]),s("div",O,[e[17]||(e[17]=s("div",{class:"flex justify-between items-center mb-6"},[s("h3",{class:"font-medium text-lg"},"个人信息设置"),s("p",{class:"text-gray-500 text-sm"},"更新您的个人资料")],-1)),o(h,{model:l.value,rules:F,ref_key:"profileForm",ref:_,"label-width":"100px",class:"profile-form"},{default:n(()=>[s("div",Z,[o(d,{label:"用户名",class:"form-item-modern"},{default:n(()=>[o(p,{modelValue:l.value.name,"onUpdate:modelValue":e[4]||(e[4]=a=>l.value.name=a),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),o(d,{label:"手机号",prop:"phone",class:"form-item-modern"},{default:n(()=>[o(p,{modelValue:l.value.phone,"onUpdate:modelValue":e[5]||(e[5]=a=>l.value.phone=a),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),o(d,{label:"邮箱",prop:"email",class:"form-item-modern"},{default:n(()=>[o(p,{modelValue:l.value.email,"onUpdate:modelValue":e[6]||(e[6]=a=>l.value.email=a),placeholder:"请输入邮箱地址"},null,8,["modelValue"])]),_:1})]),o(d,{label:"车牌号",class:"form-item-modern"},{default:n(()=>[s("div",D,[s("div",L,[(m(!0),P(N,null,j(l.value.licensePlates,(a,A)=>(m(),b(S,{key:a,closable:"",onClose:X=>I(A),type:"info",class:"plate-tag"},{default:n(()=>[f(q(a),1)]),_:2},1032,["onClose"]))),128))]),s("div",R,[o(p,{modelValue:i.value,"onUpdate:modelValue":e[7]||(e[7]=a=>i.value=a),placeholder:"添加车牌号",style:{width:"200px"},size:"default",onKeyup:z(w,["enter"]),maxlength:"10"},null,8,["modelValue"]),o(C,{type:"primary",onClick:w,disabled:!i.value},{default:n(()=>e[15]||(e[15]=[s("i",{class:"fa fa-plus mr-1"},null,-1),f(" 添加 ")])),_:1,__:[15]},8,["disabled"])])])]),_:1}),o(d,{class:"form-item-modern"},{default:n(()=>[o(C,{type:"primary",onClick:U,class:"save-btn"},{default:n(()=>e[16]||(e[16]=[s("i",{class:"fa fa-save mr-2"},null,-1),f(" 保存修改 ")])),_:1,__:[16]})]),_:1})]),_:1},8,["model"])])])}}},te=B(G,[["__scopeId","data-v-b9f7f8fc"]]);export{te as default};
