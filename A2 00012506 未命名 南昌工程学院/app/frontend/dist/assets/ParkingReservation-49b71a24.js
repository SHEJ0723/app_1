import{g as ke}from"./parking-f1dd034f.js";import{c as q}from"./orders-5a34db32.js";import{g as he}from"./license_plates-ef7f679b.js";import{_ as G,X as we,H as F,o as n,c as r,F as V,J as D,N as H,B as Z,d as t,Y as Se,r as _,s as $e,E as c,b as $,e as o,f as u,h as x,t as v,l as E,j as B,C as J,L}from"./index-06309a7e.js";import"./cacheManager-5937ebc8.js";import"./index-d5848531.js";const Ce={class:"skeleton-container"},Ve={key:0,class:"skeleton-list"},De={key:1,class:"skeleton-card"},Te={key:2,class:"skeleton-table"},Re={class:"skeleton-table-header"},ze={key:3,class:"skeleton-form"},Be={key:4,class:"skeleton-detail"},je={class:"skeleton-detail-content"},Me={key:5,class:"skeleton-custom"},Pe={key:6,class:"skeleton-default"},Ie={__name:"SkeletonScreen",props:{type:{type:String,default:"default",validator:g=>["list","card","table","form","detail","custom","default"].includes(g)},count:{type:Number,default:5},rows:{type:Number,default:5},columns:{type:Number,default:4},fields:{type:Number,default:4},show:{type:Boolean,default:!0},customStyle:{type:Object,default:()=>({})}},setup(g){we(w=>({b780434a:g.columns}));const k=g;return F(()=>({...k.customStyle})),(w,f)=>(n(),r("div",Ce,[g.type==="list"?(n(),r("div",Ve,[(n(!0),r(V,null,D(g.count,m=>(n(),r("div",{key:m,class:"skeleton-item",style:H({animationDelay:`${m*.1}s`})},f[0]||(f[0]=[Z('<div class="skeleton-avatar" data-v-dd6cf9f2></div><div class="skeleton-content" data-v-dd6cf9f2><div class="skeleton-title" data-v-dd6cf9f2></div><div class="skeleton-text" data-v-dd6cf9f2></div><div class="skeleton-text short" data-v-dd6cf9f2></div></div>',2)]),4))),128))])):g.type==="card"?(n(),r("div",De,f[1]||(f[1]=[Z('<div class="skeleton-card-header" data-v-dd6cf9f2><div class="skeleton-avatar large" data-v-dd6cf9f2></div><div class="skeleton-content" data-v-dd6cf9f2><div class="skeleton-title" data-v-dd6cf9f2></div><div class="skeleton-text" data-v-dd6cf9f2></div></div></div><div class="skeleton-card-body" data-v-dd6cf9f2><div class="skeleton-text" data-v-dd6cf9f2></div><div class="skeleton-text" data-v-dd6cf9f2></div><div class="skeleton-text short" data-v-dd6cf9f2></div></div><div class="skeleton-card-footer" data-v-dd6cf9f2><div class="skeleton-button" data-v-dd6cf9f2></div><div class="skeleton-button" data-v-dd6cf9f2></div></div>',3)]))):g.type==="table"?(n(),r("div",Te,[t("div",Re,[(n(!0),r(V,null,D(g.columns,m=>(n(),r("div",{key:m,class:"skeleton-table-cell"}))),128))]),(n(!0),r(V,null,D(g.rows,m=>(n(),r("div",{key:m,class:"skeleton-table-row",style:H({animationDelay:`${m*.1}s`})},[(n(!0),r(V,null,D(g.columns,i=>(n(),r("div",{key:i,class:"skeleton-table-cell"}))),128))],4))),128))])):g.type==="form"?(n(),r("div",ze,[(n(!0),r(V,null,D(g.fields,m=>(n(),r("div",{key:m,class:"skeleton-form-field",style:H({animationDelay:`${m*.1}s`})},f[2]||(f[2]=[t("div",{class:"skeleton-label"},null,-1),t("div",{class:"skeleton-input"},null,-1)]),4))),128)),f[3]||(f[3]=t("div",{class:"skeleton-form-actions"},[t("div",{class:"skeleton-button primary"}),t("div",{class:"skeleton-button"})],-1))])):g.type==="detail"?(n(),r("div",Be,[f[5]||(f[5]=t("div",{class:"skeleton-detail-header"},[t("div",{class:"skeleton-title large"}),t("div",{class:"skeleton-subtitle"})],-1)),t("div",je,[(n(),r(V,null,D(6,m=>t("div",{key:m,class:"skeleton-detail-item",style:H({animationDelay:`${m*.1}s`})},f[4]||(f[4]=[t("div",{class:"skeleton-label"},null,-1),t("div",{class:"skeleton-text"},null,-1)]),4)),64))])])):g.type==="custom"?(n(),r("div",Me,[Se(w.$slots,"default",{},void 0,!0)])):(n(),r("div",Pe,f[6]||(f[6]=[t("div",{class:"skeleton-loading"},[t("div",{class:"skeleton-spinner"}),t("div",{class:"skeleton-text"},"加载中...")],-1)])))]))}},Ne=G(Ie,[["__scopeId","data-v-dd6cf9f2"]]);const Le={class:"fade-in"},Ye={class:"mb-6"},Ue={class:"flex justify-between items-center"},He={class:"bg-white rounded-lg shadow-sm border border-gray-100 p-6 mb-6"},Ee={class:"flex flex-col lg:flex-row lg:justify-between lg:items-center mb-6 gap-4"},Fe={class:"flex items-center gap-3 bg-gray-50 px-4 py-3 rounded-lg border border-gray-200"},Oe={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"},qe={class:"stat-item bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-4 hover:shadow-md transition-all duration-300"},Je={class:"stat-content"},Ae={class:"stat-value text-blue-900 text-2xl font-bold"},Qe={class:"stat-item bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-xl p-4 hover:shadow-md transition-all duration-300"},Xe={class:"stat-content"},Ze={class:"stat-value text-green-900 text-2xl font-bold"},Ge={class:"stat-item bg-gradient-to-br from-orange-50 to-orange-100 border border-orange-200 rounded-xl p-4 hover:shadow-md transition-all duration-300"},Ke={class:"stat-content"},We={class:"stat-value text-orange-900 text-2xl font-bold"},et={class:"stat-item bg-gradient-to-br from-red-50 to-red-100 border border-red-200 rounded-xl p-4 hover:shadow-md transition-all duration-300"},tt={class:"stat-content"},st={class:"stat-value text-red-900 text-2xl font-bold"},lt={class:"bg-white rounded-lg shadow-sm border border-gray-100 p-6"},at={class:"flex justify-between items-center mb-6"},ot={class:"font-medium text-lg text-gray-800 flex items-center"},nt={class:"ml-2 text-sm text-gray-500"},rt={class:"flex gap-2"},it={class:"overflow-x-auto rounded-lg border border-gray-200"},dt={class:"w-full"},ut={class:"py-4 px-6 text-sm font-semibold text-gray-900"},ct={class:"py-4 px-6 text-sm text-gray-700"},ft={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},mt={class:"py-4 px-6 text-sm text-gray-700"},vt={class:"py-4 px-6 text-center"},gt={class:"py-4 px-6 text-center"},pt={class:"flex flex-col gap-2"},bt={key:1,class:"text-xs text-gray-500"},xt={class:"mt-6 flex justify-center"},yt={key:1,class:"text-center py-12"},_t={key:0,class:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg"},kt={class:"flex items-center justify-between"},ht={class:"flex items-center justify-between"},wt={key:0,class:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded"},St={class:"flex justify-end gap-3"},$t={class:"mb-4"},Ct={class:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-60 overflow-y-auto"},Vt={class:"ml-3 flex-1"},Dt={class:"font-medium text-gray-900"},Tt={class:"text-sm text-gray-500"},Rt={class:"text-sm text-gray-600"},zt={class:"flex justify-between items-center"},Bt={class:"flex gap-2"},jt={__name:"ParkingReservation",setup(g){const k=_([]),w=_(!1),f=_(!1),m=_(null),i=_({plate:"",phone:"",timeRange:[],spot:null}),Y=_(""),U=_(""),j=_(1),O=_(10),P=_(0),K=[{text:"今天",value:()=>[new Date,new Date]},{text:"明天",value:()=>{const s=new Date,e=new Date;return e.setTime(e.getTime()+3600*1e3*24),s.setTime(s.getTime()+3600*1e3*24),[e,s]}},{text:"本周",value:()=>{const s=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*7),[e,s]}},{text:"下周",value:()=>{const s=new Date,e=new Date;return e.setTime(e.getTime()+3600*1e3*24*7),s.setTime(s.getTime()+3600*1e3*24*14),[e,s]}}],W=s=>s.getTime()<Date.now()-864e5,ee=(s,e)=>e==="start"?{disabledHours:()=>[],disabledMinutes:()=>[],disabledSeconds:()=>[]}:{disabledHours:()=>[],disabledMinutes:()=>[],disabledSeconds:()=>[]},te={plate:[{required:!0,message:"请选择车牌号",trigger:"change"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"手机号格式不正确",trigger:"blur"}],timeRange:[{required:!0,message:"请选择预约时间段",trigger:"change"},{validator:(s,e,a)=>{e&&e.length===2&&e[1]<=e[0]?a(new Error("结束时间必须晚于开始时间")):a()},trigger:"change"}]},S=_([]),T=_([]),se=s=>{if(i.value.plate=s,!i.value.phone){const e=JSON.parse(localStorage.getItem("userInfo"));e&&e.phone&&(i.value.phone=e.phone)}},A=async()=>{try{const s=await he();s.success?(T.value=s.data,S.value=s.data.map(e=>e.plate_number)):(console.error("获取车牌列表失败:",s.message),T.value=[],S.value=[])}catch(s){console.error("获取车牌列表失败:",s),c.error("获取车牌列表失败，请检查网络连接"),T.value=[],S.value=[]}};$e(async()=>{await A(),await C()});const le=()=>{j.value=1,C()},ae=()=>{j.value=1,C()},Q=F(()=>k.value.filter(s=>s.status==="空闲").length),oe=F(()=>k.value.filter(s=>s.status==="已预约").length),ne=F(()=>k.value.filter(s=>s.status==="已占用").length),re=s=>({空闲:"bg-green-100 text-green-800 border border-green-200",已预约:"bg-orange-100 text-orange-800 border border-orange-200",已占用:"bg-red-100 text-red-800 border border-red-200"})[s]||"bg-gray-100 text-gray-600 border border-gray-200",C=async()=>{w.value=!0;try{const s={page:j.value,per_page:O.value,...Y.value?{zone:Y.value}:{},...U.value?{type:U.value}:{}},e=await ke(s);e.success?(k.value=e.data||[],P.value=e.total):(c.error(e.message||"获取车位失败"),k.value=[],P.value=0)}catch(s){c.error(s.message||"获取车位失败"),k.value=[],P.value=0}finally{w.value=!1}};function ie(s){j.value=s,C()}function de(s){O.value=s,j.value=1,C()}function ue(s){i.value={plate:"",phone:"",timeRange:[],spot:s};const e=T.value.find(a=>a.is_default);e&&(i.value.plate=e.plate_number),f.value=!0}const I=_(!1),p=_([]);function ce(){const s=k.value.filter(e=>e.status==="空闲");if(s.length===0){c.warning("当前没有可用的空闲车位");return}p.value=s.slice(0,3),I.value=!0}function fe(s,e){e?p.value.includes(s)||p.value.push(s):p.value=p.value.filter(a=>a.id!==s.id)}async function me(){try{const s=T.value.find(y=>y.is_default);if(!s){c.warning("请先设置默认车牌");return}const e=JSON.parse(localStorage.getItem("userInfo"));if(!e||!e.id){c.error("请先登录");return}if(p.value.length===0){c.warning("请选择要预约的车位");return}const a=new Date,d=new Date(a.getTime()+2*60*60*1e3);try{await L.confirm(`确定要批量预约 ${p.value.length} 个车位吗？
使用车牌：${s.plate_number}
时间：${a.toLocaleString()} - ${d.toLocaleString()}`,"批量预约确认",{confirmButtonText:"确认预约",cancelButtonText:"取消",type:"info"});const y=p.value.map(M=>q({user_id:e.id,spot_id:M.id,start_time:R(a),end_time:R(d),status:"未支付",amount:0})),z=(await Promise.all(y)).filter(M=>M.success).length;if(z>0){c.success(`批量预约成功！成功预约 ${z} 个车位`),I.value=!1,await C();try{await L.confirm(`批量预约成功！成功预约 ${z} 个车位，状态已更新。
是否立即查看订单详情？`,"批量预约成功",{confirmButtonText:"查看订单",cancelButtonText:"继续预约",type:"success"}),window.location.href="/user/orders"}catch{console.log("用户选择继续预约")}}else c.error("批量预约失败，请稍后重试")}catch(y){y==="cancel"||y==="close"?c.info("已取消批量预约"):(console.error("批量预约失败:",y),c.error("批量预约失败，请稍后重试"))}}catch(s){console.error("批量预约失败:",s),c.error("批量预约失败，请稍后重试")}}async function ve(s){try{const e=T.value.find(h=>h.is_default);if(!e){c.warning("请先设置默认车牌");return}const a=JSON.parse(localStorage.getItem("userInfo"));if(!a||!a.id){c.error("请先登录");return}const d=new Date,y=new Date(d.getTime()+2*60*60*1e3);try{await L.confirm(`确定要快速预约 ${s.spot_number} 车位吗？
使用车牌：${e.plate_number}
时间：${d.toLocaleString()} - ${y.toLocaleString()}`,"快速预约确认",{confirmButtonText:"确认预约",cancelButtonText:"取消",type:"info"});const h=await q({user_id:a.id,spot_id:s.id,start_time:R(d),end_time:R(y),status:"未支付",amount:0});if(h.success){c.success("快速预约成功！车位已锁定"),await C();try{await L.confirm(`快速预约成功！车位状态已更新。
是否立即查看订单详情？`,"预约成功",{confirmButtonText:"查看订单",cancelButtonText:"继续预约",type:"success"}),window.location.href="/user/orders"}catch{console.log("用户选择继续预约")}}else c.error(h.message||"快速预约失败")}catch(h){h==="cancel"||h==="close"?c.info("已取消预约"):(console.error("快速预约失败:",h),c.error("快速预约失败，请稍后重试"))}}catch(e){console.error("快速预约失败:",e),c.error("快速预约失败，请稍后重试")}}function ge(){f.value=!1,window.location.href="/user/plates"}function pe(){i.value={plate:"",phone:"",timeRange:[],spot:null},m.value&&m.value.resetFields()}function R(s){const e=new Date(s),a=d=>d<10?"0"+d:d;return`${e.getFullYear()}-${a(e.getMonth()+1)}-${a(e.getDate())} ${a(e.getHours())}:${a(e.getMinutes())}:${a(e.getSeconds())}`}const be=()=>{console.log("开始预约，表单数据:",i.value),m.value.validate(async s=>{if(console.log("表单验证结果:",s),!s){console.log("表单验证失败");return}try{const e=JSON.parse(localStorage.getItem("userInfo"));if(!e||!e.id){c.error("请先登录");return}console.log("用户信息:",e),console.log("预约参数:",{user_id:e.id,spot_id:i.value.spot.id,start_time:R(i.value.timeRange[0]),end_time:R(i.value.timeRange[1]),status:"未支付",amount:0});const a=await q({user_id:e.id,spot_id:i.value.spot.id,start_time:R(i.value.timeRange[0]),end_time:R(i.value.timeRange[1]),status:"未支付",amount:0});if(console.log("预约结果:",a),a.success){c.success("预约成功，车位已锁定！"),f.value=!1,await C();try{await L.confirm(`预约成功！车位状态已更新。
是否立即查看订单详情？`,"预约成功",{confirmButtonText:"查看订单",cancelButtonText:"继续预约",type:"success"}),window.location.href="/user/orders"}catch{console.log("用户选择继续预约")}}else c.error(a.message||"预约失败")}catch(e){console.error("预约失败:",e),e.response&&e.response.data?c.error(e.response.data.message||"预约失败，请稍后重试"):c.error("预约失败，请检查网络连接")}})};return(s,e)=>{const a=$("el-button"),d=$("el-option"),y=$("el-select"),h=$("el-pagination"),z=$("el-form-item"),M=$("el-input"),xe=$("el-date-picker"),ye=$("el-form"),X=$("el-dialog"),_e=$("el-checkbox");return n(),r("div",Le,[t("div",Ye,[t("div",Ue,[e[14]||(e[14]=t("div",null,[t("h2",{class:"text-[clamp(1.25rem,3vw,1.75rem)] font-semibold"},"预订车位"),t("p",{class:"text-gray-500 mt-1"},"选择并预约您需要的停车位")],-1)),o(a,{type:"primary",onClick:e[0]||(e[0]=l=>s.$router.push("/user")),class:"back-btn"},{default:u(()=>e[13]||(e[13]=[t("i",{class:"fa fa-arrow-left mr-2"},null,-1),x(" 返回首页 ")])),_:1,__:[13]})])]),t("div",He,[t("div",Ee,[e[16]||(e[16]=t("h3",{class:"font-medium text-lg text-gray-800"},"车位选择",-1)),t("div",Fe,[e[15]||(e[15]=t("span",{class:"text-sm font-medium text-gray-600 flex items-center"},[t("i",{class:"fa fa-filter mr-2 text-blue-500"}),x(" 筛选条件 ")],-1)),o(y,{modelValue:Y.value,"onUpdate:modelValue":e[1]||(e[1]=l=>Y.value=l),placeholder:"选择分区",onChange:le,class:"zone-select",style:{width:"140px"}},{default:u(()=>[o(d,{label:"全部区域",value:""}),o(d,{label:"A区 - 普通车位",value:"A"}),o(d,{label:"B区 - 普通车位",value:"B"}),o(d,{label:"C区 - 混合车位",value:"C"}),o(d,{label:"D区 - 充电车位",value:"D"}),o(d,{label:"E区 - 无障碍车位",value:"E"}),o(d,{label:"F区 - 新能源车位",value:"F"})]),_:1},8,["modelValue"]),o(y,{modelValue:U.value,"onUpdate:modelValue":e[2]||(e[2]=l=>U.value=l),placeholder:"选择类型",onChange:ae,class:"type-select",style:{width:"140px"}},{default:u(()=>[o(d,{label:"全部类型",value:""}),o(d,{label:"普通车位",value:"普通"}),o(d,{label:"大型车位",value:"大型"}),o(d,{label:"新能源车位",value:"新能源"}),o(d,{label:"无障碍车位",value:"无障碍"})]),_:1},8,["modelValue"])])]),t("div",Oe,[t("div",qe,[e[18]||(e[18]=t("div",{class:"stat-icon bg-blue-500 text-white rounded-full w-12 h-12 flex items-center justify-center mb-3"},[t("i",{class:"fa fa-car text-lg"})],-1)),t("div",Je,[e[17]||(e[17]=t("p",{class:"stat-label text-blue-700 font-medium"},"总车位",-1)),t("p",Ae,v(P.value),1)])]),t("div",Qe,[e[20]||(e[20]=t("div",{class:"stat-icon bg-green-500 text-white rounded-full w-12 h-12 flex items-center justify-center mb-3"},[t("i",{class:"fa fa-check-circle text-lg"})],-1)),t("div",Xe,[e[19]||(e[19]=t("p",{class:"stat-label text-green-700 font-medium"},"可用车位",-1)),t("p",Ze,v(Q.value),1)])]),t("div",Ge,[e[22]||(e[22]=t("div",{class:"stat-icon bg-orange-500 text-white rounded-full w-12 h-12 flex items-center justify-center mb-3"},[t("i",{class:"fa fa-clock-o text-lg"})],-1)),t("div",Ke,[e[21]||(e[21]=t("p",{class:"stat-label text-orange-700 font-medium"},"已预约",-1)),t("p",We,v(oe.value),1)])]),t("div",et,[e[24]||(e[24]=t("div",{class:"stat-icon bg-red-500 text-white rounded-full w-12 h-12 flex items-center justify-center mb-3"},[t("i",{class:"fa fa-ban text-lg"})],-1)),t("div",tt,[e[23]||(e[23]=t("p",{class:"stat-label text-red-700 font-medium"},"已占用",-1)),t("p",st,v(ne.value),1)])])])]),t("div",lt,[t("div",at,[t("h3",ot,[e[25]||(e[25]=t("i",{class:"fa fa-list mr-2 text-blue-500"},null,-1)),e[26]||(e[26]=x(" 车位列表 ")),t("span",nt," (已绑定 "+v(S.value.length)+" 个车牌) ",1)]),t("div",rt,[S.value.length>0&&Q.value>0?(n(),E(a,{key:0,type:"success",size:"small",onClick:ce,class:"batch-reserve-btn",title:"批量预约空闲车位"},{default:u(()=>e[27]||(e[27]=[t("i",{class:"fa fa-th-large mr-1"},null,-1),x(" 批量预约 ")])),_:1,__:[27]})):B("",!0),o(a,{type:"primary",size:"small",onClick:A,loading:w.value,class:"refresh-btn"},{default:u(()=>e[28]||(e[28]=[t("i",{class:"fa fa-car mr-1"},null,-1),x(" 刷新车牌 ")])),_:1,__:[28]},8,["loading"]),o(a,{type:"primary",size:"small",onClick:C,loading:w.value,class:"refresh-btn"},{default:u(()=>e[29]||(e[29]=[t("i",{class:"fa fa-refresh mr-1"},null,-1),x(" 刷新车位 ")])),_:1,__:[29]},8,["loading"])])]),t("div",it,[t("table",dt,[e[32]||(e[32]=t("thead",null,[t("tr",{class:"bg-gradient-to-r from-gray-50 to-gray-100 border-b border-gray-200"},[t("th",{class:"text-left py-4 px-6 text-sm font-semibold text-gray-700 uppercase tracking-wide"},"车位号"),t("th",{class:"text-left py-4 px-6 text-sm font-semibold text-gray-700 uppercase tracking-wide"},"分区"),t("th",{class:"text-left py-4 px-6 text-sm font-semibold text-gray-700 uppercase tracking-wide"},"类型"),t("th",{class:"text-center py-4 px-6 text-sm font-semibold text-gray-700 uppercase tracking-wide"},"状态"),t("th",{class:"text-center py-4 px-6 text-sm font-semibold text-gray-700 uppercase tracking-wide"},"操作")])],-1)),t("tbody",null,[(n(!0),r(V,null,D(k.value,(l,b)=>(n(),r("tr",{key:l.id,class:J(["border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200",b%2===0?"bg-white":"bg-gray-50"])},[t("td",ut,v(l.spot_number),1),t("td",ct,[t("span",ft,v(l.zone)+"区 ",1)]),t("td",mt,v(l.type),1),t("td",vt,[t("span",{class:J([re(l.status),"px-3 py-1.5 rounded-full text-xs font-medium"])},v(l.status),3)]),t("td",gt,[t("div",pt,[o(a,{type:"primary",size:"small",disabled:S.value.length===0||l.status!=="空闲",onClick:N=>ue(l),class:"reserve-btn hover:shadow-md transition-all duration-200",title:S.value.length===0?"请先绑定车牌":"点击预约此车位"},{default:u(()=>[e[30]||(e[30]=t("i",{class:"fa fa-calendar-plus mr-1"},null,-1)),x(" "+v(S.value.length===0?"需绑定车牌":"立即预约"),1)]),_:2,__:[30]},1032,["disabled","onClick","title"]),S.value.length>0&&l.status==="空闲"?(n(),E(a,{key:0,type:"success",size:"small",onClick:N=>ve(l),class:"quick-reserve-btn hover:shadow-md transition-all duration-200",title:"快速预约（使用默认车牌）"},{default:u(()=>e[31]||(e[31]=[t("i",{class:"fa fa-bolt mr-1"},null,-1),x(" 快速预约 ")])),_:2,__:[31]},1032,["onClick"])):B("",!0),l.status!=="空闲"?(n(),r("div",bt,v(l.status==="已占用"||l.status==="占用"?"车位已占用":l.status==="已预约"||l.status==="预约"?"车位已预约":"车位不可用"),1)):B("",!0)])])],2))),128))])])]),t("div",xt,[o(h,{"current-page":j.value,"page-size":O.value,total:P.value,onCurrentChange:ie,onSizeChange:de,layout:"total, sizes, prev, pager, next, jumper","page-sizes":[5,10,20,50]},null,8,["current-page","page-size","total"])]),w.value?(n(),E(Ne,{key:0,type:"table",rows:5,columns:5,class:"mb-6"})):B("",!0),k.value.length===0&&!w.value?(n(),r("div",yt,e[33]||(e[33]=[t("i",{class:"fa fa-car text-4xl text-gray-300 mb-4"},null,-1),t("p",{class:"text-gray-500"},"暂无可用车位",-1)]))):B("",!0)]),o(X,{modelValue:f.value,"onUpdate:modelValue":e[7]||(e[7]=l=>f.value=l),title:"填写预约信息",width:"500px",onClosed:pe,class:"reserve-dialog"},{footer:u(()=>[t("div",St,[o(a,{onClick:e[6]||(e[6]=l=>f.value=!1),class:"cancel-btn"},{default:u(()=>e[36]||(e[36]=[x("取消")])),_:1,__:[36]}),o(a,{type:"primary",disabled:!i.value.plate||!i.value.phone||!i.value.timeRange||i.value.timeRange.length!==2,onClick:be,class:"confirm-btn",loading:w.value},{default:u(()=>e[37]||(e[37]=[t("i",{class:"fa fa-check mr-1"},null,-1),x(" 确定预约 ")])),_:1,__:[37]},8,["disabled","loading"])])]),default:u(()=>[S.value.length===0?(n(),r("div",_t,[t("div",kt,[e[35]||(e[35]=t("div",{class:"flex items-center"},[t("i",{class:"fa fa-exclamation-triangle text-red-500 mr-2"}),t("span",{class:"text-red-700"},"请先绑定车牌后再预约！")],-1)),o(a,{type:"primary",size:"small",onClick:ge,class:"ml-2"},{default:u(()=>e[34]||(e[34]=[t("i",{class:"fa fa-plus mr-1"},null,-1),x(" 去绑定车牌 ")])),_:1,__:[34]})])])):B("",!0),o(ye,{model:i.value,rules:te,ref_key:"formRef",ref:m,"label-width":"100px",class:"reserve-form"},{default:u(()=>[o(z,{label:"车牌号",prop:"plate",class:"form-item-modern"},{default:u(()=>[o(y,{modelValue:i.value.plate,"onUpdate:modelValue":e[3]||(e[3]=l=>i.value.plate=l),placeholder:"请选择车牌号",style:{width:"100%"},filterable:"",clearable:"",onChange:se},{default:u(()=>[(n(!0),r(V,null,D(T.value,l=>(n(),E(d,{key:l.id,label:l.plate_number+(l.is_default?" (默认)":""),value:l.plate_number},{default:u(()=>[t("div",ht,[t("span",null,v(l.plate_number),1),l.is_default?(n(),r("span",wt,"默认")):B("",!0)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(z,{label:"手机号",prop:"phone",class:"form-item-modern"},{default:u(()=>[o(M,{modelValue:i.value.phone,"onUpdate:modelValue":e[4]||(e[4]=l=>i.value.phone=l),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),o(z,{label:"预约时间段",prop:"timeRange",class:"form-item-modern"},{default:u(()=>[o(xe,{modelValue:i.value.timeRange,"onUpdate:modelValue":e[5]||(e[5]=l=>i.value.timeRange=l),type:"datetimerange","start-placeholder":"开始时间","end-placeholder":"结束时间",style:{width:"100%"},format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",shortcuts:K,"disabled-date":W,"disabled-time":ee},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),o(X,{modelValue:I.value,"onUpdate:modelValue":e[12]||(e[12]=l=>I.value=l),title:"批量预约车位",width:"600px",class:"batch-reserve-dialog"},{footer:u(()=>[t("div",zt,[o(a,{onClick:e[9]||(e[9]=l=>I.value=!1),class:"cancel-btn"},{default:u(()=>e[41]||(e[41]=[x("取消")])),_:1,__:[41]}),t("div",Bt,[o(a,{type:"info",size:"small",onClick:e[10]||(e[10]=l=>p.value=k.value.filter(b=>b.status==="空闲").slice(0,3))},{default:u(()=>e[42]||(e[42]=[x(" 选择前3个 ")])),_:1,__:[42]}),o(a,{type:"warning",size:"small",onClick:e[11]||(e[11]=l=>p.value=[])},{default:u(()=>e[43]||(e[43]=[x(" 清空选择 ")])),_:1,__:[43]}),o(a,{type:"primary",disabled:p.value.length===0,onClick:me,class:"confirm-btn"},{default:u(()=>[e[44]||(e[44]=t("i",{class:"fa fa-check mr-1"},null,-1)),x(" 确认批量预约 ("+v(p.value.length)+") ",1)]),_:1,__:[44]},8,["disabled"])])])]),default:u(()=>{var l;return[e[45]||(e[45]=t("div",{class:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg"},[t("div",{class:"flex items-center"},[t("i",{class:"fa fa-info-circle text-blue-500 mr-2"}),t("span",{class:"text-blue-700"},"选择要批量预约的车位，系统将使用您的默认车牌进行预约")])],-1)),t("div",$t,[e[39]||(e[39]=t("h4",{class:"font-medium text-gray-800 mb-3"},"可预约车位列表：",-1)),t("div",Ct,[(n(!0),r(V,null,D(k.value.filter(b=>b.status==="空闲"),b=>(n(),r("div",{key:b.id,class:J(["flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",{"bg-blue-50 border-blue-300":p.value.includes(b)}])},[o(_e,{modelValue:p.value,"onUpdate:modelValue":e[8]||(e[8]=N=>p.value=N),value:b,onChange:N=>fe(b,N)},null,8,["modelValue","value","onChange"]),t("div",Vt,[t("div",Dt,v(b.spot_number),1),t("div",Tt,v(b.zone)+"区 - "+v(b.type),1)]),e[38]||(e[38]=t("span",{class:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full"}," 空闲 ",-1))],2))),128))])]),t("div",Rt,[t("p",null,"• 已选择 "+v(p.value.length)+" 个车位",1),e[40]||(e[40]=t("p",null,"• 预约时间：当前时间起2小时",-1)),t("p",null,"• 使用车牌："+v(((l=T.value.find(b=>b.is_default))==null?void 0:l.plate_number)||"未设置默认车牌"),1)])]}),_:1,__:[45]},8,["modelValue"])])}}},Ut=G(jt,[["__scopeId","data-v-0e804925"]]);export{Ut as default};
